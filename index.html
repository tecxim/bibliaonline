<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#3498db">
  <title>Random Bible Reading</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #f0f8ff;
      color: #333;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }
    .container {
      background: #fff;
      padding: 30px 20px 20px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      max-width: 750px;
      width: 95%;
      position: relative;
      margin-top: 80px;
      margin-bottom: 20px;
    }
    h1 {
      text-align: center;
      margin-bottom: 20px;
      color: #2c3e50;
      font-weight: 600;
      font-size: 1.4rem;
    }
    .reference {
      text-align: center;
      font-weight: bold;
      font-size: 1.2rem;
      margin-bottom: 15px;
      color: #3498db;
    }
    .chapter-text {
      line-height: 1.7;
      white-space: pre-wrap;
      max-height: 400px;
      overflow-y: auto;
      background-color: #fdfdfd;
      padding: 20px;
      border-radius: 8px;
      border: 1px solid #e0e0e0;
      margin-bottom: 20px;
      font-size: 1.1rem;
    }
    .buttons {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin-top: 15px;
      flex-wrap: wrap;
    }
    button {
      padding: 12px 20px;
      background-color: #3498db;
      color: #fff;
      border: none;
      border-radius: 6px;
      font-size: 1rem;
      cursor: pointer;
      transition: background-color 0.3s;
      min-width: 150px;
    }
    button:hover {
      background-color: #2980b9;
    }
    footer {
      text-align: center;
      margin-top: 20px;
      font-size: 0.85rem;
      color: #7f8c8d;
    }
    .menu {
      position: fixed;
      top: 20px;
      right: 20px;
      display: flex;
      gap: 10px;
      z-index: 100;
    }
    .menu-btn {
      background-color: #2ecc71;
      color: white;
      padding: 10px 15px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 500;
    }
    .menu-btn:hover {
      background-color: #27ae60;
    }
    .menu-content {
      display: none;
      position: fixed;
      background-color: #f9f9f9;
      min-width: 250px;
      box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
      z-index: 1;
      right: 20px;
      border-radius: 6px;
      overflow: hidden;
      top: 60px;
    }
    .menu-content a {
      color: #333;
      padding: 12px 16px;
      text-decoration: none;
      display: block;
      text-align: left;
      border-bottom: 1px solid #ddd;
      transition: background-color 0.3s;
    }
    .menu-content a:hover {
      background-color: #f1f1f1;
    }
    .menu-btn:hover + .menu-content,
    .menu-content:hover {
      display: block;
    }
    .language-selector {
      display: flex;
      justify-content: center;
      margin-bottom: 20px;
      gap: 10px;
      flex-wrap: wrap;
    }
    .language-btn {
      padding: 8px 16px;
      background-color: #95a5a6;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    .language-btn.active {
      background-color: #3498db;
    }
    .language-btn:hover:not(.active) {
      background-color: #7f8c8d;
    }
    @media (max-width: 600px) {
      .container {
        padding: 20px 15px;
        margin-top: 70px;
      }
      h1 {
        font-size: 1.2rem;
      }
      .reference {
        font-size: 1.1rem;
      }
      .chapter-text {
        font-size: 1rem;
        padding: 15px;
      }
      button {
        padding: 10px 15px;
        font-size: 0.9rem;
      }
      .menu {
        top: 10px;
        right: 10px;
      }
      .menu-content {
        top: 50px;
        min-width: 200px;
      }
    }
    .share-container {
      display: flex;
      justify-content: center;
      margin-top: 15px;
    }
  </style>
</head>
<body>
  <div class="menu">
    <div class="menu-btn">Books and eBooks</div>
    <div class="menu-content">
      <a href="https://www.amazon.com/dp/B0FW58HKDC" target="_blank">
        How to Let God Use You (Amazon.com - EN)
      </a>
      <a href="https://www.amazon.com.br/dp/B0FVTTBN52" target="_blank">
        Como Deixar Deus te Usar (Amazon.com.br - PT)
      </a>
    </div>
    <div class="menu-btn" onclick="showHelp()">Learn how to use the app</div>
  </div>
  <div class="container">
    <h1>Random Bible Reading</h1>
    <div class="language-selector">
      <button class="language-btn active" onclick="setLanguage('kjv')">English (KJV)</button>
    </div>
    <div class="reference" id="reference">Loading reference...</div>
    <div class="chapter-text" id="chapterText">Please wait...</div>
    <div class="buttons">
      <button onclick="loadRandomChapter()">Read another chapter</button>
    </div>
    <footer>
      <p>EN: Bible available in English (KJV) â€” public domain â€” no ad banners.</p>
    </footer>
    <div class="share-container">
      <button id="shareBtn">ðŸ“¤ Share</button>
    </div>
  </div>
  <script>
    let currentLanguage = 'kjv';
    let bibleData = {};

    // Lista de livros e capÃ­tulos da BÃ­blia KJV
    const books = [
      { name: "Genesis", chapters: 50 },
      { name: "Exodus", chapters: 40 },
      { name: "Leviticus", chapters: 27 },
      { name: "Numbers", chapters: 36 },
      { name: "Deuteronomy", chapters: 34 },
      { name: "Joshua", chapters: 24 },
      { name: "Judges", chapters: 21 },
      { name: "Ruth", chapters: 4 },
      { name: "1 Samuel", chapters: 31 },
      { name: "2 Samuel", chapters: 24 },
      { name: "1 Kings", chapters: 22 },
      { name: "2 Kings", chapters: 25 },
      { name: "1 Chronicles", chapters: 29 },
      { name: "2 Chronicles", chapters: 36 },
      { name: "Ezra", chapters: 10 },
      { name: "Nehemiah", chapters: 13 },
      { name: "Esther", chapters: 10 },
      { name: "Job", chapters: 42 },
      { name: "Psalms", chapters: 150 },
      { name: "Proverbs", chapters: 31 },
      { name: "Ecclesiastes", chapters: 12 },
      { name: "Song of Solomon", chapters: 8 },
      { name: "Isaiah", chapters: 66 },
      { name: "Jeremiah", chapters: 52 },
      { name: "Lamentations", chapters: 5 },
      { name: "Ezekiel", chapters: 48 },
      { name: "Daniel", chapters: 12 },
      { name: "Hosea", chapters: 14 },
      { name: "Joel", chapters: 3 },
      { name: "Amos", chapters: 9 },
      { name: "Obadiah", chapters: 1 },
      { name: "Jonah", chapters: 4 },
      { name: "Micah", chapters: 7 },
      { name: "Nahum", chapters: 3 },
      { name: "Habakkuk", chapters: 3 },
      { name: "Zephaniah", chapters: 3 },
      { name: "Haggai", chapters: 2 },
      { name: "Zechariah", chapters: 14 },
      { name: "Malachi", chapters: 4 },
      { name: "Matthew", chapters: 28 },
      { name: "Mark", chapters: 16 },
      { name: "Luke", chapters: 24 },
      { name: "John", chapters: 21 },
      { name: "Acts", chapters: 28 },
      { name: "Romans", chapters: 16 },
      { name: "1 Corinthians", chapters: 16 },
      { name: "2 Corinthians", chapters: 13 },
      { name: "Galatians", chapters: 6 },
      { name: "Ephesians", chapters: 6 },
      { name: "Philippians", chapters: 4 },
      { name: "Colossians", chapters: 4 },
      { name: "1 Thessalonians", chapters: 5 },
      { name: "2 Thessalonians", chapters: 3 },
      { name: "1 Timothy", chapters: 6 },
      { name: "2 Timothy", chapters: 4 },
      { name: "Titus", chapters: 3 },
      { name: "Philemon", chapters: 1 },
      { name: "Hebrews", chapters: 13 },
      { name: "James", chapters: 5 },
      { name: "1 Peter", chapters: 5 },
      { name: "2 Peter", chapters: 3 },
      { name: "1 John", chapters: 5 },
      { name: "2 John", chapters: 1 },
      { name: "3 John", chapters: 1 },
      { name: "Jude", chapters: 1 },
      { name: "Revelation", chapters: 22 }
    ];

    // Carrega o arquivo JSON da BÃ­blia KJV
    async function loadBibleData() {
      try {
        const response = await fetch('bible_kjv.json');
        if (!response.ok) {
          throw new Error("Failed to load KJV Bible data.");
        }
        bibleData = await response.json();
      } catch (err) {
        console.error("Error loading Bible data:", err);
        alert("Error loading Bible data. Please check the console for details.");
      }
    }

    function setLanguage(lang) {
      currentLanguage = lang;
      document.querySelectorAll('.language-btn').forEach(btn => {
        btn.classList.remove('active');
      });
      document.querySelector(`.language-btn[onclick="setLanguage('${lang}')"]`).classList.add('active');
      loadRandomChapter();
    }

    function getRandomReference() {
      const book = books[Math.floor(Math.random() * books.length)];
      const chapter = Math.floor(Math.random() * book.chapters) + 1;
      return { book: book.name, chapter };
    }

    function getChapter(book, chapter) {
      const bookKey = book.replace(/\s+/g, '_').toLowerCase();
      if (!bibleData[bookKey]) {
        throw new Error(`Book "${book}" not found in the Bible data.`);
      }
      if (!bibleData[bookKey][chapter]) {
        throw new Error(`Chapter ${chapter} not found in ${book}.`);
      }
      return bibleData[bookKey][chapter];
    }

    function displayChapter(book, chapter, verses) {
      document.getElementById("reference").textContent = `${book} ${chapter}`;
      const versesText = verses.map(v => `${v.verse}. ${v.text.trim()}`).join("\n\n");
      document.getElementById("chapterText").textContent = versesText;
    }

    async function loadRandomChapter() {
      document.getElementById("reference").textContent = "Loading reference...";
      document.getElementById("chapterText").textContent = "Loading chapter...";
      try {
        const { book, chapter } = getRandomReference();
        const verses = getChapter(book, chapter);
        displayChapter(book, chapter, verses);
      } catch (err) {
        document.getElementById("reference").textContent = "Error";
        document.getElementById("chapterText").textContent = err.message;
        console.error(err);
      }
    }

    function showHelp() {
      alert("To use the app:\n1. Click 'Read another chapter' to load a random chapter.\n2. The app will display the chapter in English (KJV).\n3. Use the menu to access related books and eBooks.");
    }

    const shareBtn = document.getElementById('shareBtn');
    shareBtn.addEventListener('click', async () => {
      const shareData = {
        title: 'Bible Reading Site',
        text: 'Check out this Bible reading site â€” available in English (KJV), public domain, and no ad banners!',
        url: window.location.href
      };
      if (navigator.share) {
        try {
          await navigator.share(shareData);
          console.log('Content shared successfully.');
        } catch (err) {
          console.error('Error sharing:', err);
        }
      } else {
        alert('Sharing is not supported on this device. Copy this link: ' + window.location.href);
      }
    });

    window.onload = function() {
      loadBibleData();
      loadRandomChapter();
    };
  </script>
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('sw.js')
        .then(() => console.log('Service Worker registered successfully.'))
        .catch(err => console.log('Error registering Service Worker:', err));
    }
  </script>
</body>
</html>
